<!doctype html>
<html lang="ja" data-theme="light">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>社員編集画面</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    </head>
    <body>
        <nav>
            <ul>
                <li><strong>リソース管理システム</strong></li>
            </ul>
            <ul>
                <li><a href="/dashboard">ダッシュボード</a></li>
                <li><a href="/pcs/view">PC管理</a></li>
                <li><a href="/employees/view">社員管理</a></li>
                <li><a href="/departments/view">部署管理</a></li>
                <li><a href="/history/view">履歴管理</a></li>
            </ul>
        </nav>
        <main class="container">
        <h1>社員編集</h1>

        <form method="POST" action="/employees/{{ employee.id }}/edit">
            <label>
                名前:
                <input
                    type="text"
                    name="name"
                    value="{{ employee.name }}"
                    required
                />
            </label>

            <label>
                メールアドレス:
                <input
                    type="email"
                    name="email"
                    value="{{ employee.email }}"
                    required
                />
            </label>

            <label>
                部署:
                <select name="department_id" required>
                    <option value="">-- 部署を選択 --</option>
                    {% for department in departments %}
                    <option
                        value="{{ department.id }}"
                        {% if employee.department_id == department.id %}selected{% endif %}
                    >
                        {{ department.name }}
                    </option>
                    {% endfor %}
                </select>
            </label>

            <label>
                退職予定日 (任意):
                <input type="date" name="resignation_date" value="{% if employee.resignation_date %}{{ employee.resignation_date }}{% endif %}" />
                <small>退職予定がある場合に入力してください</small>
            </label>

            <label>
                異動予定日 (任意):
                <input type="date" name="transfer_date" value="{% if employee.transfer_date %}{{ employee.transfer_date }}{% endif %}" />
                <small>異動予定がある場合に入力してください</small>
            </label>

            <label>
                権限:
                <select name="role" required>
                    <option value="user" {% if employee.role.value == 'user' %}selected{% endif %}>一般ユーザー</option>
                    <option value="admin" {% if employee.role.value == 'admin' %}selected{% endif %}>管理者</option>
                </select>
            </label>

            <button type="submit">更新</button>
        </form>

        <h3>プロフィール画像</h3>
        <img src="/employees/{{ employee.id }}/image" alt="プロフィール画像" style="max-width: 200px; border-radius: 8px;" onerror="this.style.display='none'">
        <form method="POST" action="/employees/{{ employee.id }}/upload-image" enctype="multipart/form-data">
            <input type="file" name="data" accept="image/*" required>
            <button type="submit">画像アップロード (5MB以内)</button>
        </form>

        <a href="/employees/view" role="button" class="secondary">← 一覧に戻る</a>
        </main>
    </body>
</html>
